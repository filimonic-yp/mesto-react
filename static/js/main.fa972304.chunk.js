(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{17:function(e,t,r){},18:function(e,t,r){},19:function(e,t,r){},20:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r(1),i=r.n(n),o=r(10),s=r.n(o),c=(r(17),r(11)),d=r(2),l=r(3),u=r(5),p=r(4);r(18);var h=function(){return Object(a.jsx)("header",{className:"header",children:Object(a.jsx)("div",{className:"header__logo"})})},_={name:"",about:"",avatar:"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",_id:void 0},b=i.a.createContext();function m(e){var t=i.a.useContext(b),r=e.card.likes.some((function(e){return e._id===t._id})),n=e.card.owner._id===t._id,o=e.card.likes.length;return Object(a.jsxs)("li",{className:"card",children:[Object(a.jsx)("img",{className:"card__image",src:e.card.link,alt:e.card.name,onClick:e.onClick}),Object(a.jsx)("p",{className:"card__caption",children:e.card.name}),Object(a.jsxs)("div",{className:"card__like-control",children:[Object(a.jsx)("button",{className:"card__btn-like hover-breathing hover-breathing_deep ".concat(r&&"card__btn-like_liked"),type:"button",onClick:e.onCardLike}),Object(a.jsx)("p",{className:"card__like-counter",children:o})]}),Object(a.jsx)("button",{className:"card__btn-remove hover-breathing hover-breathing_deep ".concat(!n&&"card__btn-remove_hidden"),type:"button",onClick:e.onCardDelete})]})}var j=function(e){Object(u.a)(r,e);var t=Object(p.a)(r);function r(e){var a;return Object(d.a)(this,r),(a=t.call(this,e)).updateMe=function(e){var t=e.name,r=e.about,n=e.avatar;a.setState({userName:t,userDescription:r,userAvatar:n})},a.state={userName:"",userDescription:"",userAvatar:"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="},a}return Object(l.a)(r,[{key:"render",value:function(){var e=this;return Object(a.jsxs)("main",{className:"main page__margin-wrapper",children:[Object(a.jsxs)("section",{className:"profile",children:[Object(a.jsxs)("div",{className:"profile__avatar-box",children:[Object(a.jsx)("img",{className:"profile__avatar",alt:"".concat(this.context.name,", ").concat(this.context.about),src:this.context.avatar}),Object(a.jsx)("button",{className:"profile__btn-set-avatar",type:"button",onClick:this.props.onEditAvatar})]}),Object(a.jsxs)("div",{className:"profile__info",children:[Object(a.jsxs)("div",{className:"profile__display-name-wrapper",children:[Object(a.jsx)("h1",{className:"profile__display-name",children:this.context.name}),Object(a.jsx)("button",{className:"profile__btn-edit hover-breathing hover-breathing_deep",type:"button",onClick:this.props.onEditProfile})]}),Object(a.jsx)("p",{className:"profile__job",children:this.context.about})]}),Object(a.jsx)("button",{className:"profile__btn-add hover-breathing hover-breathing_deep",type:"button",onClick:this.props.onAddPlace})]}),Object(a.jsx)("ul",{className:"cards",children:this.props.cards.map((function(t){return Object(a.jsx)(m,{card:t,onClick:function(){return e.props.onCardClick(t)},onCardLike:function(){return e.props.onCardLike(t)},onCardDelete:function(){return e.props.onCardDelete(t)}},t._id)}))})]})}}]),r}(i.a.Component);j.contextType=b;var f=j,v=r(6),O=function(e){Object(u.a)(r,e);var t=Object(p.a)(r);function r(e){return Object(d.a)(this,r),t.call(this,e)}return Object(l.a)(r,[{key:"render",value:function(){var e=this;return Object(a.jsx)("div",{className:"popup popup-editor popup-editor_".concat(this.props.name," ").concat(this.props.isOpen&&"popup_opened"),onClick:function(t){return t.target===t.currentTarget&&e.props.onClose()},children:Object(a.jsx)("div",{className:"popup__editor-container",children:Object(a.jsxs)("form",{onSubmit:this.props.onSubmit,className:"editor",name:"editor_".concat(this.props.name),noValidate:!0,children:[Object(a.jsx)("p",{className:"editor__title",children:this.props.title}),this.props.children,Object(a.jsx)("button",{className:"editor__btn-submit hover-breathing hover-breathing_shallow",type:"submit",name:"submit",value:"save-info",children:this.props.buttonTextNormal}),Object(a.jsx)("button",{className:"popup__btn-close editor__btn-close hover-breathing hover-breathing_deep",type:"button",onClick:this.props.onClose})]})})})}}]),r}(i.a.Component);var A=function(e){var t=i.a.useContext(b),r=i.a.useState(""),n=Object(v.a)(r,2),o=n[0],s=n[1],c=i.a.useState(""),d=Object(v.a)(c,2),l=d[0],u=d[1];return i.a.useEffect((function(){s(t.name),u(t.about)}),[t]),Object(a.jsxs)(O,{name:"profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",buttonTextNormal:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",buttonTextProgress:"\u0421\u043e\u0445\u0440\u0430\u043d\u044f\u044e...",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:o,about:l})},children:[Object(a.jsx)("input",{onChange:function(e){s(e.target.value)},value:o,className:"editor__input editor__input_display-name",type:"text",autoComplete:"name","data-error-element-id":"editor_profile__display-name-error",placeholder:"\u0418\u043c\u044f",name:"display-name",required:!0,maxLength:"40",minLength:"2"}),Object(a.jsx)("span",{className:"editor__error editor__error_hidden",id:"editor_profile__display-name-error",children:" "}),Object(a.jsx)("input",{onChange:function(e){u(e.target.value)},value:l,className:"editor__input editor__input_job",type:"text",name:"job","data-error-element-id":"editor_profile__job-error",placeholder:"\u0420\u043e\u0434 \u0437\u0430\u043d\u044f\u0442\u0438\u0439",required:!0,maxLength:"200",minLength:"2"}),Object(a.jsx)("span",{className:"editor__error editor__error_hidden",id:"editor_profile__job-error",children:" "})]})};var C=function(e){var t=i.a.useContext(b),r=i.a.useRef(),n=i.a.useState(t.avatar),o=Object(v.a)(n,2),s=(o[0],o[1]);return i.a.useEffect((function(){s(t.avatar)}),[t]),Object(a.jsxs)(O,{name:"avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",buttonTextNormal:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",buttonTextProgress:"\u0421\u043e\u0445\u0440\u0430\u043d\u044f\u044e...",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateAvatar(r.current.value)},children:[Object(a.jsx)("input",{ref:r,className:"editor__input editor__input_url",type:"url",name:"image-url","data-error-element-id":"editor_image-adder__image-url-error",required:!0,placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443 \u0430\u0432\u0430\u0442\u0430\u0440\u0430"}),Object(a.jsx)("span",{className:"editor__error editor__error_hidden",id:"editor_image-adder__image-url-error"})]})};var x=function(e){var t=i.a.useState(""),r=Object(v.a)(t,2),n=r[0],o=r[1],s=i.a.useState(""),c=Object(v.a)(s,2),d=c[0],l=c[1];return Object(a.jsxs)(O,{name:"image-adder",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",buttonTextNormal:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",buttonTextProgress:"\u0421\u043e\u0437\u0434\u0430\u044e...",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault();var r={name:n,link:d};o(""),l(""),e.onAddPlace(r)},children:[Object(a.jsx)("input",{onChange:function(e){o(e.target.value)},value:n,className:"editor__input editor__input_display-name",type:"text",name:"display-name","data-error-element-id":"editor_image-adder__display-name-error",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",required:!0,maxLength:"30",minLength:"1"}),Object(a.jsx)("span",{className:"editor__error editor__error_hidden",id:"editor_image-adder__display-name-error",children:" "}),Object(a.jsx)("input",{onChange:function(e){l(e.target.value)},value:d,className:"editor__input editor__input_url",type:"url",name:"image-url","data-error-element-id":"editor_image-adder__image-url-error",required:!0,placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443"}),Object(a.jsx)("span",{className:"editor__error editor__error_hidden",id:"editor_image-adder__image-url-error",children:" "})]})},g=function(e){Object(u.a)(r,e);var t=Object(p.a)(r);function r(){return Object(d.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"render",value:function(){var e=this;return Object(a.jsx)("div",{className:"popup popup-viewer ".concat(this.props.isOpen&&"popup_opened"),onClick:function(t){return t.target===t.currentTarget&&e.props.onClose()},children:Object(a.jsxs)("div",{className:"viewer popup__viewer-container",children:[Object(a.jsx)("button",{className:"popup__btn-close viewer__btn-close hover-breathing hover-breathing_deep",type:"button",onClick:this.props.onClose}),Object(a.jsx)("img",{className:"viewer__image",src:this.props.card&&this.props.card.link,alt:this.props.card&&this.props.card.name}),Object(a.jsx)("p",{className:"viewer__title",children:this.props.card&&this.props.card.name})]})})}}]),r}(i.a.Component);r(19);var k=function(){return Object(a.jsx)("footer",{className:"footer page__margin-wrapper",children:"\xa9 2020 Mesto Russia"})},P={baseUrl:"https://mesto.nomoreparties.co/v1/cohort-16",headers:{"Content-Type":"application/json",authorization:"21fa6b5f-35b5-4dfd-b2f6-88404e0e94c4"}},N=new(function(){function e(t){var r=t.baseUrl,a=t.headers;Object(d.a)(this,e),this._baseUrl=r,this._headers=a}return Object(l.a)(e,[{key:"_fetch",value:function(e){var t=e.method,r=void 0===t?"GET":t,a=e.urlPart,n=e.payload,i=this._baseUrl+a,o=Object.assign({},{headers:this._headers},{method:r},n?{body:JSON.stringify(n)}:void 0);return fetch(i,o).then((function(e){return e.ok?e.json():Promise.reject("Server respond with ".concat(e.status))})).catch((function(e){return console.error("Something went wrong",e),Promise.reject(e)}))}},{key:"getInitialCards",value:function(){return this._fetch({urlPart:"/cards"})}},{key:"sendCard",value:function(e){var t=e.name,r=e.link;return this._fetch({method:"POST",urlPart:"/cards",payload:{name:t,link:r}})}},{key:"deleteCard",value:function(e){return this._fetch({method:"DELETE",urlPart:"/cards/".concat(e)})}},{key:"likeCard",value:function(e){return this._fetch({method:"PUT",urlPart:"/cards/likes/".concat(e)})}},{key:"dislikeCard",value:function(e){return this._fetch({method:"DELETE",urlPart:"/cards/likes/".concat(e)})}},{key:"getMe",value:function(){return this._fetch({urlPart:"/users/me"})}},{key:"updateMe",value:function(e){var t=e.name,r=e.about;return this._fetch({method:"PATCH",urlPart:"/users/me",payload:{name:t,about:r}})}},{key:"setAvatar",value:function(e){return this._fetch({method:"PATCH",urlPart:"/users/me/avatar",payload:{avatar:e}})}}]),e}())(P),y=function(e){Object(u.a)(r,e);var t=Object(p.a)(r);function r(e){var a;return Object(d.a)(this,r),(a=t.call(this,e)).handleEditAvatarClick=function(){return a.setState({isEditAvatarPopupOpen:!0})},a.handleEditProfileClick=function(){return a.setState({isEditProfilePopupOpen:!0})},a.handleAddPlaceClick=function(){return a.setState({isAddPlacePopupOpen:!0})},a.handleCardClick=function(e){return a.setState({selectedCard:e})},a.handleCardLike=function(e){console.log("hcl",e),(e.likes.some((function(e){return e._id===a.state.currentUser._id}))?N.dislikeCard(e._id):N.likeCard(e._id)).then((function(e){return a.updateCards(a.state.cards.map((function(t){return t._id===e._id?e:t})))})).catch((function(e){return console.error("Unable to process like",e)}))},a.handleCardDelete=function(e){N.deleteCard(e._id).then(a.setState({cards:a.state.cards.filter((function(t){return e._id!==t._id}))})).catch((function(e){return console.error("Unable to delete card",e)}))},a.updateCards=function(e){a.setState({cards:e})},a.handleUpdateUser=function(e){a.closeAllPopups(),N.updateMe(e).then((function(e){return a.setState({currentUser:e})})).catch((function(e){return console.error("Error updating user",e)}))},a.handleUpdateAvatar=function(e){a.closeAllPopups(),N.setAvatar(e).then((function(e){return a.setState({currentUser:e})})).catch((function(e){return console.error("Error updating user avatar",e)}))},a.handleAddPlaceSubmit=function(e){a.closeAllPopups(),N.sendCard(e).then((function(e){return a.setState({cards:[e].concat(Object(c.a)(a.state.cards))})})).catch((function(e){return console.error("Error adding card",e)}))},a.closeAllPopups=function(){a.setState({isAddPlacePopupOpen:!1,isEditProfilePopupOpen:!1,isEditAvatarPopupOpen:!1,selectedCard:void 0})},a.state={isEditProfilePopupOpen:!1,isAddPlacePopupOpen:!1,isEditAvatarPopupOpen:!1,selectedCard:void 0,currentUser:_,cards:[]},a}return Object(l.a)(r,[{key:"componentDidMount",value:function(){var e=this;Promise.all([N.getMe().then((function(t){return e.setState({currentUser:t})})),N.getInitialCards().then((function(t){return e.updateCards(t)}))]).catch((function(e){return console.error("Error",e)}))}},{key:"render",value:function(){return Object(a.jsxs)("div",{className:"page__wrapper",children:[Object(a.jsx)(h,{}),Object(a.jsx)(b.Provider,{value:this.state.currentUser,children:Object(a.jsx)(f,{onEditAvatar:this.handleEditAvatarClick,onEditProfile:this.handleEditProfileClick,onAddPlace:this.handleAddPlaceClick,onCardClick:this.handleCardClick,onCardLike:this.handleCardLike,onCardDelete:this.handleCardDelete,cards:this.state.cards})}),Object(a.jsx)(b.Provider,{value:this.state.currentUser,children:Object(a.jsx)(A,{isOpen:this.state.isEditProfilePopupOpen,onClose:this.closeAllPopups,onUpdateUser:this.handleUpdateUser})}),Object(a.jsx)(b.Provider,{value:this.state.currentUser,children:Object(a.jsx)(C,{isOpen:this.state.isEditAvatarPopupOpen,onClose:this.closeAllPopups,onUpdateAvatar:this.handleUpdateAvatar})}),Object(a.jsx)(x,{isOpen:this.state.isAddPlacePopupOpen,onClose:this.closeAllPopups,onAddPlace:this.handleAddPlaceSubmit}),Object(a.jsx)(g,{isOpen:!!this.state.selectedCard,card:this.state.selectedCard,onClose:this.closeAllPopups}),Object(a.jsx)(k,{})]})}}]),r}(i.a.Component);s.a.render(Object(a.jsx)(i.a.StrictMode,{children:Object(a.jsx)(y,{})}),document.getElementById("root"))}},[[20,1,2]]]);
//# sourceMappingURL=main.fa972304.chunk.js.map